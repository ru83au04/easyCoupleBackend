import{f as k}from"./chunk-WB2HZI4U.js";import{a as W}from"./chunk-4HEFJ4X4.js";import{a as j,b as B,c as z,e as H}from"./chunk-P4BSPYCZ.js";import{c as L}from"./chunk-N3KMV4DD.js";import{a as M,c as N,d as F}from"./chunk-RT2YAMBY.js";import{f as S}from"./chunk-Y2NSYKDS.js";import"./chunk-ZEQWP7YF.js";import{a as R,d as I,f as E,k as A,l as b}from"./chunk-622SOSYF.js";import"./chunk-4TDNJBFX.js";import{l as U,m as V}from"./chunk-7JZTCISL.js";import{Db as s,Eb as a,Jb as h,Ob as m,Qb as l,Tb as O,Yb as g,Za as d,_a as u,ac as f,bc as x,cc as w,f as P,jb as y,ka as c,la as p,pb as v,ua as C,wb as _}from"./chunk-55BIBHTM.js";function X(r,n){if(r&1){let e=h();s(0,"div",3)(1,"input",4),w("ngModelChange",function(t){c(e);let o=l();return x(o.username,t)||(o.username=t),p(t)}),m("input",function(t){c(e);let o=l();return p(o.onInputChange(t))}),a(),s(2,"input",5),w("ngModelChange",function(t){c(e);let o=l();return x(o.password,t)||(o.password=t),p(t)}),m("input",function(t){c(e);let o=l();return p(o.onInputChange(t))}),a(),s(3,"input",6),w("ngModelChange",function(t){c(e);let o=l();return x(o.checkPassword,t)||(o.checkPassword=t),p(t)}),m("input",function(t){c(e);let o=l();return p(o.onInputChange(t))}),a(),s(4,"div",7)(5,"button",8),m("click",function(){c(e);let t=l();return p(t.checkUser())}),g(6,"\u8A3B\u518A"),a(),s(7,"button",8),m("click",function(){c(e);let t=l();return p(t.closeRegist())}),g(8,"\u53D6\u6D88"),a()()()}if(r&2){let e=l();d(),f("ngModel",e.username),d(),f("ngModel",e.password),d(),f("ngModel",e.checkPassword)}}function $(r,n){if(r&1){let e=h();s(0,"input",15),w("ngModelChange",function(t){let o=c(e).$implicit;return x(o.name,t)||(o.name=t),p(t)}),m("input",function(t){let o=c(e).$implicit,K=l(2);return p(o.placeholder.endsWith("\u96FB\u8A71")?K.onPhoneChange(t):"")}),a()}if(r&2){let e=n.$implicit;O("type",e.type),O("placeholder",e.placeholder),f("ngModel",e.name)}}function ee(r,n){if(r&1){let e=h();s(0,"div",9)(1,"div")(2,"div",10)(3,"div")(4,"label"),g(5,"\u5230\u8077\u65E5\u671F"),a(),s(6,"input",11),w("ngModelChange",function(t){c(e);let o=l();return x(o.start_date,t)||(o.start_date=t),p(t)}),a()()()(),s(7,"div",12),v(8,$,1,3,"input",13),a(),s(9,"div")(10,"textarea",14),w("ngModelChange",function(t){c(e);let o=l();return x(o.address,t)||(o.address=t),p(t)}),a()(),s(11,"div",7)(12,"button",8),m("click",function(){c(e);let t=l();return p(t.registUser())}),g(13,"\u78BA\u8A8D"),a(),s(14,"button",8),m("click",function(){c(e);let t=l();return p(t.closeRegist())}),g(15,"\u53D6\u6D88"),a()()()}if(r&2){let e=l();d(6),f("ngModel",e.start_date),d(2),_("ngForOf",e.basicData),d(2),f("ngModel",e.address)}}var D=class r{constructor(n,e){this.userSrv=n;this.alert=e;this.roles=Object.keys(N).filter(i=>isNaN(Number(i))),this.departments=Object.keys(F).filter(i=>isNaN(Number(i)))}finishRegist=new C;close=new C;roles;departments;checkPassword;username="";password="";address="";start_date=new Date;role;department;detail=!1;basicData=[{name:"",type:"text",placeholder:"\u771F\u5BE6\u59D3\u540D(\u5FC5\u586B)"},{name:"",type:"text",placeholder:"\u96FB\u8A71"},{name:"",type:"text",placeholder:"\u7DCA\u6025\u806F\u7D61\u4EBA(\u5FC5\u586B)"},{name:"",type:"text",placeholder:"\u7DCA\u6025\u806F\u7D61\u4EBA\u96FB\u8A71"}];ngOnInit(){}checkUser(){if(this.username&&this.password&&this.checkPassword===this.password)try{this.userSrv.checkUser(this.username,this.password).subscribe({next:n=>{n.status===200?n.data[0]?(console.log("\u4F7F\u7528\u8005\u5DF2\u5B58\u5728"),this.alert.showAlert("\u4F7F\u7528\u8005\u5DF2\u5B58\u5728")):(this.checkPassword="",this.detail=!0):(console.log("\u4E0D\u660E\u554F\u984C"),this.alert.showAlert("\u4E0D\u660E\u554F\u984C"))},error:n=>{console.log(`\u78BA\u8A8D\u5931\u6557\uFF1A${n.status}`,n.message),this.alert.showAlert(`\u78BA\u8A8D\u5931\u6557\uFF1A${n.message}`)}})}catch(n){console.error("\u78BA\u8A8D\u5931\u6557",n),this.alert.showAlert("\u78BA\u8A8D\u5931\u6557")}else this.alert.showAlert("\u8ACB\u78BA\u8A8D\u5E33\u865F\u3001\u5BC6\u78BC")}registUser(){if(this.username&&this.password&&this.basicData[0].name!=""&&this.basicData[2].name!=""){let n={username:this.username,password:this.password,real_name:this.basicData[0].name,emergency:this.basicData[2].name,address:this.address,start_date:this.start_date,role_id:2,department_id:2,phone:this.basicData[1].name,emergency_phone:this.basicData[3].name};try{this.userSrv.registUser(n).subscribe({next:e=>{e.status===200?(this.username="",this.password="",this.basicData[0].name="",this.basicData[1].name="",this.basicData[2].name="",this.basicData[3].name="",this.address="",this.start_date=new Date,this.role="",this.department="",this.alert.showAlert(`\u8A3B\u518A\u6210\u529F\uFF1A${e.data[0].username}`,()=>{this.closeRegist()})):this.alert.showAlert("\u8A3B\u518A\u5931\u6557")},error:e=>{console.log(`\u8A3B\u518A\u5931\u6557\uFF1A ${e.status}`,e.error.message),this.alert.showAlert(`\u8A3B\u518A\u5931\u6557\uFF1A ${e.error.message}`)}})}catch(e){this.alert.showAlert("\u8A3B\u518A\u5931\u6557"),console.error("\u8A3B\u518A\u5931\u6557",e)}}else console.log("\u8A3B\u518A\u8CC7\u6599\u4E0D\u5B8C\u6574"),this.alert.showAlert("\u8A3B\u518A\u8CC7\u6599\u4E0D\u5B8C\u6574")}closeRegist(){this.close.emit(!1)}onInputChange(n){let e=n.target;e.value.match(/[^a-zA-Z0-9]/g)&&(this.alert.showAlert("\u8ACB\u4F7F\u7528\u82F1\u6587\u6216\u6578\u5B57"),e.value=e.value.replace(/[^a-zA-Z0-9]/g,""))}onPhoneChange(n){let e=n.target;e.value.match(/[^0-9]/g)&&(this.alert.showAlert("\u8ACB\u4F7F\u7528\u6578\u5B57"),e.value=e.value.replace(/[^0-9]/g,""))}static \u0275fac=function(e){return new(e||r)(u(M),u(S))};static \u0275cmp=y({type:r,selectors:[["app-regist"]],outputs:{finishRegist:"finishRegist",close:"close"},decls:3,vars:2,consts:[[1,"container"],["class","regist-container",4,"ngIf"],["class","step2",4,"ngIf"],[1,"regist-container"],["type","text","maxlength","10","placeholder","\u8F38\u5165\u5E33\u865F",3,"ngModelChange","input","ngModel"],["type","password","maxlength","10","placeholder","\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","input","ngModel"],["type","password","maxlength","10","placeholder","\u518D\u6B21\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","input","ngModel"],[1,"button-container"],[3,"click"],[1,"step2"],[1,"select-container"],["type","date",3,"ngModelChange","ngModel"],[1,"basic-data"],["maxlength","10",3,"type","ngModel","placeholder","ngModelChange","input",4,"ngFor","ngForOf"],["placeholder","\u8F38\u5165\u806F\u7D61\u5730\u5740",1,"address",3,"ngModelChange","ngModel"],["maxlength","10",3,"ngModelChange","input","type","ngModel","placeholder"]],template:function(e,i){e&1&&(s(0,"div",0),v(1,X,9,3,"div",1)(2,ee,16,3,"div",2),a()),e&2&&(d(),_("ngIf",!i.detail),d(),_("ngIf",i.detail))},dependencies:[b,R,I,A,E,V,U],styles:[".container[_ngcontent-%COMP%]{margin:70px;display:flex;justify-content:center;align-items:center}.regist-container[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:30px;border:1px solid var(--text-color);width:300px}.step2[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:500px;align-items:center}.select-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.address[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:300px;height:40px}input[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:200px;height:10px}select[_ngcontent-%COMP%]{background:#fff;width:200px;color:#000}.button-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin:10px}.button-container[_ngcontent-%COMP%]{justify-content:space-evenly}button[_ngcontent-%COMP%]{height:40px;width:80px;border:1px solid #ccc;border-radius:10px;background-color:var(--title-color);color:var(--text-color);font-size:1.2rem}@media (max-width: 786px){.basic-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}}"]})};var T=class r{constructor(n,e,i){this.userSrv=n;this.alert=e;this.router=i}finishLogin=new C;cancel=new C;loginName="";loginPassword="";loginUser(){return P(this,null,function*(){if(this.loginName===""||this.loginPassword===""){this.alert.showAlert("\u8ACB\u8F38\u5165\u5E33\u865For\u5BC6\u78BC");return}try{this.userSrv.loginUser(this.loginName,this.loginPassword).subscribe({next:n=>{n.status===200?(sessionStorage.setItem("easy_couple_token",n.data[0]),this.loginName="",this.loginPassword="",this.alert.showAlert("\u767B\u5165\u6210\u529F",()=>{this.router.navigate(["/user-operation/user-info"])})):(console.log("\u4E0D\u660E\u932F\u8AA4"),this.alert.showAlert("\u4E0D\u660E\u932F\u8AA4"))},error:n=>{console.log(`\u767B\u5165\u5931\u6557\uFF1A${n.status}`,n.error.message),this.alert.showAlert(`\u767B\u5165\u5931\u6557\uFF1A${n.error.message}`)}})}catch(n){this.alert.showAlert("\u767B\u5165\u5931\u6557"),console.error("\u767B\u5165\u5931\u6557",n)}})}cancelLogin(){this.cancel.emit(!1)}static \u0275fac=function(e){return new(e||r)(u(M),u(S),u(k))};static \u0275cmp=y({type:r,selectors:[["app-login"]],outputs:{finishLogin:"finishLogin",cancel:"cancel"},decls:9,vars:2,consts:[[1,"container"],[1,"login-container"],["matInput","","type","text","maxlength","10","placeholder","\u8F38\u5165\u5E33\u865F",3,"ngModelChange","ngModel"],["matInput","","type","password","maxlength","10","placeholder","\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","ngModel"],[1,"button-container"],[3,"click"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"input",2),w("ngModelChange",function(o){return x(i.loginName,o)||(i.loginName=o),o}),a(),s(3,"input",3),w("ngModelChange",function(o){return x(i.loginPassword,o)||(i.loginPassword=o),o}),a(),s(4,"div",4)(5,"button",5),m("click",function(){return i.loginUser()}),g(6,"\u767B\u5165"),a(),s(7,"button",5),m("click",function(){return i.cancelLogin()}),g(8,"\u53D6\u6D88"),a()()()()),e&2&&(d(2),f("ngModel",i.loginName),d(),f("ngModel",i.loginPassword))},dependencies:[b,R,I,A,E,L,z,B,j,H],styles:[".container[_ngcontent-%COMP%]{margin:50px;display:flex;justify-content:center;align-items:center}.login-container[_ngcontent-%COMP%]{margin:50px;padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:30px;border:1px solid var(--text-color);width:300px}input[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:200px;height:10px}.button-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin:10px}button[_ngcontent-%COMP%]{height:40px;width:80px;border:1px solid #ccc;border-radius:10px;background-color:var(--title-color);color:var(--text-color);font-size:1.2rem}"]})};function ne(r,n){if(r&1){let e=h();s(0,"app-direction",5),m("close",function(t){c(e);let o=l();return p(o.onClose(t))}),a()}if(r&2){let e=l();_("content",e.content)}}function ie(r,n){if(r&1){let e=h();s(0,"button",6),m("click",function(){c(e);let t=l();return p(t.openDirection())}),g(1,"\u4F7F\u7528\u8AAA\u660E"),a()}}function oe(r,n){if(r&1){let e=h();s(0,"div",7)(1,"div",8),m("click",function(){c(e);let t=l();return p(t.showPage("regist"))}),g(2,"\u8A3B\u518A"),a(),s(3,"div",8),m("click",function(){c(e);let t=l();return p(t.showPage("login"))}),g(4,"\u767B\u5165"),a()()}}function re(r,n){if(r&1){let e=h();s(0,"app-regist",9),m("close",function(t){c(e);let o=l();return p(o.onCancel(t))}),a()}}function se(r,n){if(r&1){let e=h();s(0,"app-login",10),m("cancel",function(t){c(e);let o=l();return p(o.onCancel(t))}),a()}}var J=class r{constructor(n,e,i){this.userSrv=n;this.alertSrv=e;this.router=i}alertMessage="";showAlert=!1;showRegistPage=!1;showLoginPage=!1;direction=!0;content={title:"\u4F7F\u7528\u8005\u7CFB\u7D71",content:`
    \u8A3B\u518A\u4F7F\u7528\u8005
      1. \u8F38\u5165\u5E33\u865F\u5BC6\u78BC\u9EDE\u9078\u8A3B\u518A\u5F8C\uFF0C\u7CFB\u7D71\u6703\u81EA\u52D5\u6AA2\u67E5\uFF1A
        a. \u5E33\u865F\u540D\u7A31\u662F\u5426\u5DF2\u88AB\u4F7F\u7528
        b. \u78BA\u8A8D\u5BC6\u78BC\u662F\u5426\u6B63\u78BA
      2. \u5E33\u865F\u3001\u5BC6\u78BC\u78BA\u8A8D\u6C92\u554F\u984C\u5F8C\uFF0C\u6703\u8981\u6C42\u8F38\u5165\u57FA\u672C\u8CC7\u8A0A\uFF0C\u5FC5\u586B\u6B04\u4F4D\u586B\u59A5\u5F8C\u9EDE\u9078\u78BA\u8A8D\uFF0C\u6703\u6709\u901A\u77E5\u8996\u7A97\u986F\u793A\u8A3B\u518A\u7D50\u679C
    \u767B\u5165\u4F7F\u7528\u8005
      1. \u4F7F\u7528\u5DF2\u8A3B\u518A\u7684\u5E33\u865F\u3001\u5BC6\u78BC\u767B\u5165
      2. \u767B\u5165\u5F8C\u53EF\u4EE5\u4FEE\u6539\u90E8\u5206\u4F7F\u7528\u8005\u8CC7\u8A0A
      3. \u9EDE\u9078\u767B\u51FA\u53EF\u4EE5\u767B\u51FA\u5E33\u865F
      \u5099\u8A3B\uFF1A\u884C\u4E8B\u66C6\u8207\u51FA\u52E4\u6253\u5361\u529F\u80FD\u76EE\u524D\u5EFA\u7F6E\u4E2D
    `};ngOnInit(){}showPage(n){n==="login"?(this.showLoginPage=!0,this.showRegistPage=!1):(this.showRegistPage=!0,this.showLoginPage=!1)}onCancel(n){this.showRegistPage=n,this.showLoginPage=n}onClosedAlert(n){this.showAlert=n,sessionStorage.getItem("easy_couple_token")&&this.router.navigate(["/user-operation"])}deleteUser(n){return P(this,null,function*(){try{let e=localStorage.getItem("token");if(!e){console.log("\u8ACB\u5148\u767B\u5165");return}n&&n!==0?this.userSrv.deleteUser(e,n).subscribe({next:i=>{i.status===200?console.log("\u522A\u9664\u6210\u529F"):console.log("\u4E0D\u660E\u539F\u56E0\u522A\u9664\u5931\u6557")},error:i=>{throw console.log(`\u522A\u9664\u5931\u6557\uFF1A${i.status}`,i.message),i}}):console.log("\u8ACB\u8F38\u5165\u6709\u6548ID")}catch(e){console.error("\u522A\u9664\u5931\u6557",e)}})}openDirection(){this.direction=!0}onClose(n){console.log("hidden"),this.direction=n}static \u0275fac=function(e){return new(e||r)(u(M),u(S),u(k))};static \u0275cmp=y({type:r,selectors:[["app-user-system"]],decls:6,vars:5,consts:[["class","direction",3,"content","close",4,"ngIf"],["class","open-direction",3,"click",4,"ngIf"],["class","button-container",4,"ngIf"],[3,"close",4,"ngIf"],[3,"cancel",4,"ngIf"],[1,"direction",3,"close","content"],[1,"open-direction",3,"click"],[1,"button-container"],[1,"user-system-block",3,"click"],[3,"close"],[3,"cancel"]],template:function(e,i){e&1&&(v(0,ne,1,1,"app-direction",0),s(1,"div"),v(2,ie,2,0,"button",1)(3,oe,5,0,"div",2)(4,re,1,0,"app-regist",3)(5,se,1,0,"app-login",4),a()),e&2&&(_("ngIf",i.direction),d(2),_("ngIf",!i.direction),d(),_("ngIf",!i.showLoginPage&&!i.showRegistPage),d(),_("ngIf",i.showRegistPage),d(),_("ngIf",i.showLoginPage))},dependencies:[b,V,D,T,W],styles:[".direction[_ngcontent-%COMP%]{z-index:999;position:absolute;top:25%;left:50%;transform:translate(-50%,-50%);height:30%;width:70%}.open-direction[_ngcontent-%COMP%]{z-index:999;position:absolute;bottom:2%;right:2%;height:fit-content;width:fit-content;font-size:1rem;padding:5px;background-color:var(--direction-color);border:none}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:10px}.user-system-block[_ngcontent-%COMP%]{width:200px;height:150px;display:flex;flex-wrap:wrap;border-radius:30px;justify-content:center;align-items:center;font-size:2rem;letter-spacing:.5rem;margin:10px;background-color:var(--block-color)}.user-system-block[_ngcontent-%COMP%]:hover{cursor:pointer;transform:translate(10px,-10px);transition:transform .3s ease;box-shadow:-2px 2px 5px 2px #ffffff80}@media (max-width: 576px){.user-system-block[_ngcontent-%COMP%]{width:150px;height:100px;font-size:1.5rem}.direction[_ngcontent-%COMP%]{z-index:999;position:absolute;top:20%;left:50%;transform:translate(-50%,-50%);height:30%;width:70%}}"]})};export{J as UserSystemComponent};
