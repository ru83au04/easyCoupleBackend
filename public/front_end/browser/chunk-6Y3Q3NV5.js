import{f as E,k as b}from"./chunk-GLXR7B2V.js";import{f as S}from"./chunk-UDEWYARD.js";import{a as z,b as H,c as q,e as G}from"./chunk-LG2I77CF.js";import{c as j}from"./chunk-I73MXIP6.js";import{a as V,d as k,f as A,h as L,i as U,j as N,k as M}from"./chunk-J243DPSV.js";import{b as T,c as B}from"./chunk-RXVKCLZX.js";import"./chunk-23FD6YS3.js";import"./chunk-4TDNJBFX.js";import{l as F,m as R}from"./chunk-SPQETPFV.js";import{Bb as r,Cb as s,Hb as x,Kb as f,Mb as c,Pb as W,Ub as m,Vb as O,Ya as l,Yb as g,Za as w,Zb as u,_b as _,f as P,ib as v,ka as p,la as d,nb as C,ua as y,ub as h}from"./chunk-Y36Y4OMK.js";function $(a,n){if(a&1){let e=x();r(0,"div",3)(1,"input",4),_("ngModelChange",function(t){p(e);let o=c();return u(o.username,t)||(o.username=t),d(t)}),s(),r(2,"input",5),_("ngModelChange",function(t){p(e);let o=c();return u(o.password,t)||(o.password=t),d(t)}),s(),r(3,"input",6),_("ngModelChange",function(t){p(e);let o=c();return u(o.checkPassword,t)||(o.checkPassword=t),d(t)}),s(),r(4,"div",7)(5,"button",8),f("click",function(){p(e);let t=c();return d(t.checkUser())}),m(6,"\u8A3B\u518A"),s(),r(7,"button",8),f("click",function(){p(e);let t=c();return d(t.closeRegist())}),m(8,"\u53D6\u6D88"),s()()()}if(a&2){let e=c();l(),g("ngModel",e.username),l(),g("ngModel",e.password),l(),g("ngModel",e.checkPassword)}}function ee(a,n){if(a&1&&(r(0,"option",20),m(1),s()),a&2){let e=n.$implicit;h("value",e),l(),O(e)}}function te(a,n){if(a&1&&(r(0,"option",20),m(1),s()),a&2){let e=n.$implicit;h("value",e),l(),O(e)}}function ne(a,n){if(a&1){let e=x();r(0,"input",21),_("ngModelChange",function(t){let o=p(e).$implicit;return u(o.name,t)||(o.name=t),d(t)}),s()}if(a&2){let e=n.$implicit;W("type",e.type),W("placeholder",e.placeholder),g("ngModel",e.name)}}function ie(a,n){if(a&1){let e=x();r(0,"div",9)(1,"div")(2,"input",10),_("ngModelChange",function(t){p(e);let o=c();return u(o.username,t)||(o.username=t),d(t)}),s(),r(3,"input",11),_("ngModelChange",function(t){p(e);let o=c();return u(o.password,t)||(o.password=t),d(t)}),s(),r(4,"div",12)(5,"div")(6,"label"),m(7,"\u8077\u52D9(\u5FC5\u586B)"),s(),r(8,"select",13),_("ngModelChange",function(t){p(e);let o=c();return u(o.role,t)||(o.role=t),d(t)}),r(9,"option",14),m(10,"\u8ACB\u9078\u64C7\u8077\u52D9"),s(),C(11,ee,2,2,"option",15),s()(),r(12,"div")(13,"label"),m(14,"\u90E8\u9580(\u5FC5\u586B)"),s(),r(15,"select",13),_("ngModelChange",function(t){p(e);let o=c();return u(o.department,t)||(o.department=t),d(t)}),r(16,"option",16),m(17,"\u8ACB\u9078\u64C7\u90E8\u9580"),s(),C(18,te,2,2,"option",15),s()(),r(19,"div")(20,"label"),m(21,"\u5230\u8077\u65E5\u671F"),s(),r(22,"input",17),_("ngModelChange",function(t){p(e);let o=c();return u(o.start_date,t)||(o.start_date=t),d(t)}),s()()()(),r(23,"div"),C(24,ne,1,3,"input",18),s(),r(25,"div")(26,"textarea",19),_("ngModelChange",function(t){p(e);let o=c();return u(o.address,t)||(o.address=t),d(t)}),s()(),r(27,"button",8),f("click",function(){p(e);let t=c();return d(t.registUser())}),m(28,"\u78BA\u8A8D"),s()()}if(a&2){let e=c();l(2),g("ngModel",e.username),l(),g("ngModel",e.password),l(5),g("ngModel",e.role),l(3),h("ngForOf",e.roles),l(4),g("ngModel",e.department),l(3),h("ngForOf",e.departments),l(4),g("ngModel",e.start_date),l(2),h("ngForOf",e.basicData),l(2),g("ngModel",e.address)}}var D=class a{constructor(n,e){this.userSrv=n;this.alert=e;this.roles=Object.keys(T).filter(i=>isNaN(Number(i))),this.departments=Object.keys(B).filter(i=>isNaN(Number(i)))}finishRegist=new y;close=new y;roles;departments;checkPassword;username="";password="";address="";start_date=new Date;role;department;detail=!1;basicData=[{name:"",type:"text",placeholder:"\u771F\u5BE6\u59D3\u540D(\u5FC5\u586B)"},{name:"",type:"number",placeholder:"\u96FB\u8A71"},{name:"",type:"text",placeholder:"\u7DCA\u6025\u806F\u7D61\u4EBA(\u5FC5\u586B)"},{name:"",type:"number",placeholder:"\u7DCA\u6025\u806F\u7D61\u4EBA\u96FB\u8A71"}];ngOnInit(){}checkUser(){if(this.username&&this.password&&this.checkPassword===this.password)try{this.userSrv.checkUser(this.username,this.password).subscribe({next:n=>{n.status===200?n.data[0]?(console.log("\u4F7F\u7528\u8005\u5DF2\u5B58\u5728"),this.alert.showAlert("\u4F7F\u7528\u8005\u5DF2\u5B58\u5728")):(this.checkPassword="",this.detail=!0):(console.log("\u4E0D\u660E\u554F\u984C"),this.alert.showAlert("\u4E0D\u660E\u554F\u984C"))},error:n=>{console.log(`\u78BA\u8A8D\u5931\u6557\uFF1A${n.status}`,n.message),this.alert.showAlert(`\u78BA\u8A8D\u5931\u6557\uFF1A${n.message}`)}})}catch(n){console.error("\u78BA\u8A8D\u5931\u6557",n),this.alert.showAlert("\u78BA\u8A8D\u5931\u6557")}else this.alert.showAlert("\u8ACB\u78BA\u8A8D\u5E33\u865F\u3001\u5BC6\u78BC")}registUser(){if(this.username&&this.password&&this.basicData[0].name!=""&&this.basicData[2].name!=""){let n={username:this.username,password:this.password,real_name:this.basicData[0].name,emergency:this.basicData[2].name,address:this.address,start_date:this.start_date,role_id:T[this.role],department_id:B[this.department],phone:this.basicData[1].name,emergency_phone:this.basicData[3].name};try{this.userSrv.registUser(n).subscribe({next:e=>{e.status===200?(this.username="",this.password="",this.basicData[0].name="",this.basicData[1].name="",this.basicData[2].name="",this.basicData[3].name="",this.address="",this.start_date=new Date,this.role="",this.department="",this.alert.showAlert(`\u8A3B\u518A\u6210\u529F\uFF1A${e.data[0].username}`,()=>{this.closeRegist()})):this.alert.showAlert("\u8A3B\u518A\u5931\u6557")},error:e=>{console.log(`\u8A3B\u518A\u5931\u6557\uFF1A ${e.status}`,e.error.message),this.alert.showAlert(`\u8A3B\u518A\u5931\u6557\uFF1A ${e.error.message}`)}})}catch(e){this.alert.showAlert("\u8A3B\u518A\u5931\u6557"),console.error("\u8A3B\u518A\u5931\u6557",e)}}else console.log("\u8A3B\u518A\u8CC7\u6599\u4E0D\u5B8C\u6574"),this.alert.showAlert("\u8A3B\u518A\u8CC7\u6599\u4E0D\u5B8C\u6574")}closeRegist(){this.close.emit(!1)}static \u0275fac=function(e){return new(e||a)(w(b),w(S))};static \u0275cmp=v({type:a,selectors:[["app-regist"]],outputs:{finishRegist:"finishRegist",close:"close"},decls:3,vars:2,consts:[[1,"container"],["class","regist-container",4,"ngIf"],["class","step2",4,"ngIf"],[1,"regist-container"],["type","text","placeholder","\u8F38\u5165\u5E33\u865F",3,"ngModelChange","ngModel"],["type","password","placeholder","\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","ngModel"],["type","password","placeholder","\u518D\u6B21\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","ngModel"],[1,"button-container"],[3,"click"],[1,"step2"],["type","text","placeholder","\u8F38\u5165\u5E33\u865F","disabled","",3,"ngModelChange","ngModel"],["type","password","placeholder","\u8F38\u5165\u5BC6\u78BC","disabled","",3,"ngModelChange","ngModel"],[1,"select-container"],["type","text",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["value"," ","disabled","","selected",""],["type","date",3,"ngModelChange","ngModel"],[3,"type","ngModel","placeholder","ngModelChange",4,"ngFor","ngForOf"],["placeholder","\u8F38\u5165\u806F\u7D61\u5730\u5740",1,"address",3,"ngModelChange","ngModel"],[3,"value"],[3,"ngModelChange","type","ngModel","placeholder"]],template:function(e,i){e&1&&(r(0,"div",0),C(1,$,9,3,"div",1)(2,ie,29,9,"div",2),s()),e&2&&(l(),h("ngIf",!i.detail),l(),h("ngIf",i.detail))},dependencies:[M,U,N,V,L,k,A,R,F],styles:[".container[_ngcontent-%COMP%]{margin:10px;display:flex;justify-content:center;align-items:center}.regist-container[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:30px;border:1px solid var(--text-color);width:300px}.step2[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;width:300px}.select-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.address[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:440px;height:40px}input[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:200px;height:10px}select[_ngcontent-%COMP%]{background:#fff;width:200px;color:#000}.button-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin:10px}button[_ngcontent-%COMP%]{height:40px;width:80px;border:1px solid #ccc;border-radius:10px;background-color:var(--title-color);color:var(--text-color);font-size:none}"]})};var I=class a{constructor(n,e,i){this.userSrv=n;this.alert=e;this.router=i}finishLogin=new y;cancel=new y;loginName="";loginPassword="";loginUser(){return P(this,null,function*(){if(this.loginName===""||this.loginPassword===""){this.alert.showAlert("\u8ACB\u8F38\u5165\u5E33\u865For\u5BC6\u78BC");return}try{this.userSrv.loginUser(this.loginName,this.loginPassword).subscribe({next:n=>{n.status===200?(sessionStorage.setItem("easy_couple_token",n.data[0]),this.loginName="",this.loginPassword="",this.alert.showAlert("\u767B\u5165\u6210\u529F",()=>{this.router.navigate(["/user-operation"])})):(console.log("\u4E0D\u660E\u932F\u8AA4"),this.alert.showAlert("\u4E0D\u660E\u932F\u8AA4"))},error:n=>{console.log(`\u767B\u5165\u5931\u6557\uFF1A${n.status}`,n.error.message),this.alert.showAlert(`\u767B\u5165\u5931\u6557\uFF1A${n.error.message}`)}})}catch(n){this.alert.showAlert("\u767B\u5165\u5931\u6557"),console.error("\u767B\u5165\u5931\u6557",n)}})}cancelLogin(){this.cancel.emit(!1)}static \u0275fac=function(e){return new(e||a)(w(b),w(S),w(E))};static \u0275cmp=v({type:a,selectors:[["app-login"]],outputs:{finishLogin:"finishLogin",cancel:"cancel"},decls:9,vars:2,consts:[[1,"container"],[1,"login-container"],["matInput","","type","text","placeholder","\u8F38\u5165\u5E33\u865F",3,"ngModelChange","ngModel"],["matInput","","type","password","placeholder","\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","ngModel"],[1,"button-container"],[3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"input",2),_("ngModelChange",function(o){return u(i.loginName,o)||(i.loginName=o),o}),s(),r(3,"input",3),_("ngModelChange",function(o){return u(i.loginPassword,o)||(i.loginPassword=o),o}),s(),r(4,"div",4)(5,"button",5),f("click",function(){return i.loginUser()}),m(6,"\u767B\u5165"),s(),r(7,"button",5),f("click",function(){return i.cancelLogin()}),m(8,"\u53D6\u6D88"),s()()()()),e&2&&(l(2),g("ngModel",i.loginName),l(),g("ngModel",i.loginPassword))},dependencies:[M,V,k,A,j,q,H,z,G],styles:[".container[_ngcontent-%COMP%]{margin:50px;display:flex;justify-content:center;align-items:center}.login-container[_ngcontent-%COMP%]{margin:50px;padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:30px;border:1px solid var(--text-color);width:300px}input[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:200px;height:10px}.button-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin:10px}button[_ngcontent-%COMP%]{height:40px;width:80px;border:1px solid #ccc;border-radius:10px;background-color:var(--title-color);color:var(--text-color);font-size:none}"]})};function re(a,n){if(a&1){let e=x();r(0,"div",3)(1,"div",4),f("click",function(){p(e);let t=c();return d(t.showPage("regist"))}),m(2,"\u8A3B\u518A"),s(),r(3,"div",4),f("click",function(){p(e);let t=c();return d(t.showPage("login"))}),m(4,"\u767B\u5165"),s()()}}function se(a,n){if(a&1){let e=x();r(0,"app-regist",5),f("close",function(t){p(e);let o=c();return d(o.onCancel(t))}),s()}}function ae(a,n){if(a&1){let e=x();r(0,"app-login",6),f("cancel",function(t){p(e);let o=c();return d(o.onCancel(t))}),s()}}var Y=class a{constructor(n,e,i){this.userSrv=n;this.alertSrv=e;this.router=i}alertMessage="";showAlert=!1;showRegistPage=!1;showLoginPage=!1;ngOnInit(){}showPage(n){n==="login"?(this.showLoginPage=!0,this.showRegistPage=!1):(this.showRegistPage=!0,this.showLoginPage=!1)}onCancel(n){this.showRegistPage=n,this.showLoginPage=n}onClosedAlert(n){this.showAlert=n,sessionStorage.getItem("easy_couple_token")&&this.router.navigate(["/user-operation"])}deleteUser(n){return P(this,null,function*(){try{let e=localStorage.getItem("token");if(!e){console.log("\u8ACB\u5148\u767B\u5165");return}n&&n!==0?this.userSrv.deleteUser(e,n).subscribe({next:i=>{i.status===200?console.log("\u522A\u9664\u6210\u529F"):console.log("\u4E0D\u660E\u539F\u56E0\u522A\u9664\u5931\u6557")},error:i=>{throw console.log(`\u522A\u9664\u5931\u6557\uFF1A${i.status}`,i.message),i}}):console.log("\u8ACB\u8F38\u5165\u6709\u6548ID")}catch(e){console.error("\u522A\u9664\u5931\u6557",e)}})}static \u0275fac=function(e){return new(e||a)(w(b),w(S),w(E))};static \u0275cmp=v({type:a,selectors:[["app-user-system"]],decls:4,vars:3,consts:[["class","button-container",4,"ngIf"],[3,"close",4,"ngIf"],[3,"cancel",4,"ngIf"],[1,"button-container"],[1,"user-system-block",3,"click"],[3,"close"],[3,"cancel"]],template:function(e,i){e&1&&(r(0,"div"),C(1,re,5,0,"div",0)(2,se,1,0,"app-regist",1)(3,ae,1,0,"app-login",2),s()),e&2&&(l(),h("ngIf",!i.showLoginPage&&!i.showRegistPage),l(),h("ngIf",i.showRegistPage),l(),h("ngIf",i.showLoginPage))},dependencies:[M,R,D,I],styles:[".button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:10px}.user-system-block[_ngcontent-%COMP%]{width:200px;height:150px;display:flex;flex-wrap:wrap;border-radius:30px;justify-content:center;align-items:center;font-size:2rem;letter-spacing:.5rem;margin:10px;background-color:var(--block-color)}.user-system-block[_ngcontent-%COMP%]:hover{cursor:pointer;transform:translate(10px,-10px);transition:transform .3s ease;box-shadow:-2px 2px 5px 2px #ffffff80}@media (max-width: 576px){.user-system-block[_ngcontent-%COMP%]{width:150px;height:100px;font-size:1.5rem}}"]})};export{Y as UserSystemComponent};
