import{f as V}from"./chunk-7F4BBNAH.js";import{a as F,b as B,c as j,e as z}from"./chunk-AXY5MI6J.js";import{c as U}from"./chunk-SWB4232L.js";import{b as N,c as W,d as b}from"./chunk-IJAOXQSZ.js";import{f as M}from"./chunk-AUOKAUQD.js";import"./chunk-7FLEKJ5D.js";import{a as k,d as A,f as E,k as I,l as v}from"./chunk-U3Z2ZUT5.js";import"./chunk-4TDNJBFX.js";import{l as O,m as R}from"./chunk-UF3T6RJX.js";import{$b as _,Cb as r,Db as s,Ib as w,Nb as m,Pb as l,Sb as L,Xb as d,Ya as g,Za as u,ac as h,bc as f,f as P,ib as y,ka as c,la as p,ob as S,ua as C,vb as x}from"./chunk-SFNPEGCY.js";function Q(a,n){if(a&1){let e=w();r(0,"div",3)(1,"input",4),f("ngModelChange",function(t){c(e);let o=l();return h(o.username,t)||(o.username=t),p(t)}),m("input",function(t){c(e);let o=l();return p(o.onInputChange(t))}),s(),r(2,"input",5),f("ngModelChange",function(t){c(e);let o=l();return h(o.password,t)||(o.password=t),p(t)}),m("input",function(t){c(e);let o=l();return p(o.onInputChange(t))}),s(),r(3,"input",6),f("ngModelChange",function(t){c(e);let o=l();return h(o.checkPassword,t)||(o.checkPassword=t),p(t)}),m("input",function(t){c(e);let o=l();return p(o.onInputChange(t))}),s(),r(4,"div",7)(5,"button",8),m("click",function(){c(e);let t=l();return p(t.checkUser())}),d(6,"\u8A3B\u518A"),s(),r(7,"button",8),m("click",function(){c(e);let t=l();return p(t.closeRegist())}),d(8,"\u53D6\u6D88"),s()()()}if(a&2){let e=l();g(),_("ngModel",e.username),g(),_("ngModel",e.password),g(),_("ngModel",e.checkPassword)}}function X(a,n){if(a&1){let e=w();r(0,"input",14),f("ngModelChange",function(t){let o=c(e).$implicit;return h(o.name,t)||(o.name=t),p(t)}),m("input",function(t){let o=c(e).$implicit,J=l(2);return p(o.placeholder.endsWith("\u96FB\u8A71")?J.onPhoneChange(t):"")}),s()}if(a&2){let e=n.$implicit;L("type",e.type),L("placeholder",e.placeholder),_("ngModel",e.name)}}function $(a,n){if(a&1){let e=w();r(0,"div",9)(1,"div")(2,"div",10)(3,"div")(4,"label"),d(5,"\u5230\u8077\u65E5\u671F"),s(),r(6,"input",11),f("ngModelChange",function(t){c(e);let o=l();return h(o.start_date,t)||(o.start_date=t),p(t)}),s()()()(),r(7,"div"),S(8,X,1,3,"input",12),s(),r(9,"div")(10,"textarea",13),f("ngModelChange",function(t){c(e);let o=l();return h(o.address,t)||(o.address=t),p(t)}),s()(),r(11,"div",7)(12,"button",8),m("click",function(){c(e);let t=l();return p(t.registUser())}),d(13,"\u78BA\u8A8D"),s(),r(14,"button",8),m("click",function(){c(e);let t=l();return p(t.closeRegist())}),d(15,"\u53D6\u6D88"),s()()()}if(a&2){let e=l();g(6),_("ngModel",e.start_date),g(2),x("ngForOf",e.basicData),g(2),_("ngModel",e.address)}}var D=class a{constructor(n,e){this.userSrv=n;this.alert=e;this.roles=Object.keys(N).filter(i=>isNaN(Number(i))),this.departments=Object.keys(W).filter(i=>isNaN(Number(i)))}finishRegist=new C;close=new C;roles;departments;checkPassword;username="";password="";address="";start_date=new Date;role;department;detail=!1;basicData=[{name:"",type:"text",placeholder:"\u771F\u5BE6\u59D3\u540D(\u5FC5\u586B)"},{name:"",type:"text",placeholder:"\u96FB\u8A71"},{name:"",type:"text",placeholder:"\u7DCA\u6025\u806F\u7D61\u4EBA(\u5FC5\u586B)"},{name:"",type:"text",placeholder:"\u7DCA\u6025\u806F\u7D61\u4EBA\u96FB\u8A71"}];ngOnInit(){}checkUser(){if(this.username&&this.password&&this.checkPassword===this.password)try{this.userSrv.checkUser(this.username,this.password).subscribe({next:n=>{n.status===200?n.data[0]?(console.log("\u4F7F\u7528\u8005\u5DF2\u5B58\u5728"),this.alert.showAlert("\u4F7F\u7528\u8005\u5DF2\u5B58\u5728")):(this.checkPassword="",this.detail=!0):(console.log("\u4E0D\u660E\u554F\u984C"),this.alert.showAlert("\u4E0D\u660E\u554F\u984C"))},error:n=>{console.log(`\u78BA\u8A8D\u5931\u6557\uFF1A${n.status}`,n.message),this.alert.showAlert(`\u78BA\u8A8D\u5931\u6557\uFF1A${n.message}`)}})}catch(n){console.error("\u78BA\u8A8D\u5931\u6557",n),this.alert.showAlert("\u78BA\u8A8D\u5931\u6557")}else this.alert.showAlert("\u8ACB\u78BA\u8A8D\u5E33\u865F\u3001\u5BC6\u78BC")}registUser(){if(this.username&&this.password&&this.basicData[0].name!=""&&this.basicData[2].name!=""){let n={username:this.username,password:this.password,real_name:this.basicData[0].name,emergency:this.basicData[2].name,address:this.address,start_date:this.start_date,role_id:2,department_id:2,phone:this.basicData[1].name,emergency_phone:this.basicData[3].name};try{this.userSrv.registUser(n).subscribe({next:e=>{e.status===200?(this.username="",this.password="",this.basicData[0].name="",this.basicData[1].name="",this.basicData[2].name="",this.basicData[3].name="",this.address="",this.start_date=new Date,this.role="",this.department="",this.alert.showAlert(`\u8A3B\u518A\u6210\u529F\uFF1A${e.data[0].username}`,()=>{this.closeRegist()})):this.alert.showAlert("\u8A3B\u518A\u5931\u6557")},error:e=>{console.log(`\u8A3B\u518A\u5931\u6557\uFF1A ${e.status}`,e.error.message),this.alert.showAlert(`\u8A3B\u518A\u5931\u6557\uFF1A ${e.error.message}`)}})}catch(e){this.alert.showAlert("\u8A3B\u518A\u5931\u6557"),console.error("\u8A3B\u518A\u5931\u6557",e)}}else console.log("\u8A3B\u518A\u8CC7\u6599\u4E0D\u5B8C\u6574"),this.alert.showAlert("\u8A3B\u518A\u8CC7\u6599\u4E0D\u5B8C\u6574")}closeRegist(){this.close.emit(!1)}onInputChange(n){let e=n.target;e.value.match(/[^a-zA-Z0-9]/g)&&(this.alert.showAlert("\u8ACB\u4F7F\u7528\u82F1\u6587\u6216\u6578\u5B57"),e.value=e.value.replace(/[^a-zA-Z0-9]/g,""))}onPhoneChange(n){let e=n.target;e.value.match(/[^0-9]/g)&&(this.alert.showAlert("\u8ACB\u4F7F\u7528\u6578\u5B57"),e.value=e.value.replace(/[^0-9]/g,""))}static \u0275fac=function(e){return new(e||a)(u(b),u(M))};static \u0275cmp=y({type:a,selectors:[["app-regist"]],outputs:{finishRegist:"finishRegist",close:"close"},decls:3,vars:2,consts:[[1,"container"],["class","regist-container",4,"ngIf"],["class","step2",4,"ngIf"],[1,"regist-container"],["type","text","maxlength","10","placeholder","\u8F38\u5165\u5E33\u865F",3,"ngModelChange","input","ngModel"],["type","password","maxlength","10","placeholder","\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","input","ngModel"],["type","password","maxlength","10","placeholder","\u518D\u6B21\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","input","ngModel"],[1,"button-container"],[3,"click"],[1,"step2"],[1,"select-container"],["type","date",3,"ngModelChange","ngModel"],["maxlength","10",3,"type","ngModel","placeholder","ngModelChange","input",4,"ngFor","ngForOf"],["placeholder","\u8F38\u5165\u806F\u7D61\u5730\u5740",1,"address",3,"ngModelChange","ngModel"],["maxlength","10",3,"ngModelChange","input","type","ngModel","placeholder"]],template:function(e,i){e&1&&(r(0,"div",0),S(1,Q,9,3,"div",1)(2,$,16,3,"div",2),s()),e&2&&(g(),x("ngIf",!i.detail),g(),x("ngIf",i.detail))},dependencies:[v,k,A,I,E,R,O],styles:[".container[_ngcontent-%COMP%]{margin:10px;display:flex;justify-content:center;align-items:center}.regist-container[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:30px;border:1px solid var(--text-color);width:300px}.step2[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:500px;align-items:center}.select-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.address[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:300px;height:40px}input[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:200px;height:10px}select[_ngcontent-%COMP%]{background:#fff;width:200px;color:#000}.button-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin:10px}.button-container[_ngcontent-%COMP%]{justify-content:space-evenly}button[_ngcontent-%COMP%]{height:40px;width:80px;border:1px solid #ccc;border-radius:10px;background-color:var(--title-color);color:var(--text-color);font-size:1.2rem}"]})};var T=class a{constructor(n,e,i){this.userSrv=n;this.alert=e;this.router=i}finishLogin=new C;cancel=new C;loginName="";loginPassword="";loginUser(){return P(this,null,function*(){if(this.loginName===""||this.loginPassword===""){this.alert.showAlert("\u8ACB\u8F38\u5165\u5E33\u865For\u5BC6\u78BC");return}try{this.userSrv.loginUser(this.loginName,this.loginPassword).subscribe({next:n=>{n.status===200?(sessionStorage.setItem("easy_couple_token",n.data[0]),this.loginName="",this.loginPassword="",this.alert.showAlert("\u767B\u5165\u6210\u529F",()=>{this.router.navigate(["/user-operation"])})):(console.log("\u4E0D\u660E\u932F\u8AA4"),this.alert.showAlert("\u4E0D\u660E\u932F\u8AA4"))},error:n=>{console.log(`\u767B\u5165\u5931\u6557\uFF1A${n.status}`,n.error.message),this.alert.showAlert(`\u767B\u5165\u5931\u6557\uFF1A${n.error.message}`)}})}catch(n){this.alert.showAlert("\u767B\u5165\u5931\u6557"),console.error("\u767B\u5165\u5931\u6557",n)}})}cancelLogin(){this.cancel.emit(!1)}static \u0275fac=function(e){return new(e||a)(u(b),u(M),u(V))};static \u0275cmp=y({type:a,selectors:[["app-login"]],outputs:{finishLogin:"finishLogin",cancel:"cancel"},decls:9,vars:2,consts:[[1,"container"],[1,"login-container"],["matInput","","type","text","maxlength","10","placeholder","\u8F38\u5165\u5E33\u865F",3,"ngModelChange","ngModel"],["matInput","","type","password","maxlength","10","placeholder","\u8F38\u5165\u5BC6\u78BC",3,"ngModelChange","ngModel"],[1,"button-container"],[3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"input",2),f("ngModelChange",function(o){return h(i.loginName,o)||(i.loginName=o),o}),s(),r(3,"input",3),f("ngModelChange",function(o){return h(i.loginPassword,o)||(i.loginPassword=o),o}),s(),r(4,"div",4)(5,"button",5),m("click",function(){return i.loginUser()}),d(6,"\u767B\u5165"),s(),r(7,"button",5),m("click",function(){return i.cancelLogin()}),d(8,"\u53D6\u6D88"),s()()()()),e&2&&(g(2),_("ngModel",i.loginName),g(),_("ngModel",i.loginPassword))},dependencies:[v,k,A,I,E,U,j,B,F,z],styles:[".container[_ngcontent-%COMP%]{margin:50px;display:flex;justify-content:center;align-items:center}.login-container[_ngcontent-%COMP%]{margin:50px;padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:30px;border:1px solid var(--text-color);width:300px}input[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:5px;border:1px solid #ccc;width:200px;height:10px}.button-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin:10px}button[_ngcontent-%COMP%]{height:40px;width:80px;border:1px solid #ccc;border-radius:10px;background-color:var(--title-color);color:var(--text-color);font-size:1.2rem}"]})};function te(a,n){if(a&1){let e=w();r(0,"div",3)(1,"div",4),m("click",function(){c(e);let t=l();return p(t.showPage("regist"))}),d(2,"\u8A3B\u518A"),s(),r(3,"div",4),m("click",function(){c(e);let t=l();return p(t.showPage("login"))}),d(4,"\u767B\u5165"),s()()}}function ne(a,n){if(a&1){let e=w();r(0,"app-regist",5),m("close",function(t){c(e);let o=l();return p(o.onCancel(t))}),s()}}function ie(a,n){if(a&1){let e=w();r(0,"app-login",6),m("cancel",function(t){c(e);let o=l();return p(o.onCancel(t))}),s()}}var G=class a{constructor(n,e,i){this.userSrv=n;this.alertSrv=e;this.router=i}alertMessage="";showAlert=!1;showRegistPage=!1;showLoginPage=!1;ngOnInit(){}showPage(n){n==="login"?(this.showLoginPage=!0,this.showRegistPage=!1):(this.showRegistPage=!0,this.showLoginPage=!1)}onCancel(n){this.showRegistPage=n,this.showLoginPage=n}onClosedAlert(n){this.showAlert=n,sessionStorage.getItem("easy_couple_token")&&this.router.navigate(["/user-operation"])}deleteUser(n){return P(this,null,function*(){try{let e=localStorage.getItem("token");if(!e){console.log("\u8ACB\u5148\u767B\u5165");return}n&&n!==0?this.userSrv.deleteUser(e,n).subscribe({next:i=>{i.status===200?console.log("\u522A\u9664\u6210\u529F"):console.log("\u4E0D\u660E\u539F\u56E0\u522A\u9664\u5931\u6557")},error:i=>{throw console.log(`\u522A\u9664\u5931\u6557\uFF1A${i.status}`,i.message),i}}):console.log("\u8ACB\u8F38\u5165\u6709\u6548ID")}catch(e){console.error("\u522A\u9664\u5931\u6557",e)}})}static \u0275fac=function(e){return new(e||a)(u(b),u(M),u(V))};static \u0275cmp=y({type:a,selectors:[["app-user-system"]],decls:4,vars:3,consts:[["class","button-container",4,"ngIf"],[3,"close",4,"ngIf"],[3,"cancel",4,"ngIf"],[1,"button-container"],[1,"user-system-block",3,"click"],[3,"close"],[3,"cancel"]],template:function(e,i){e&1&&(r(0,"div"),S(1,te,5,0,"div",0)(2,ne,1,0,"app-regist",1)(3,ie,1,0,"app-login",2),s()),e&2&&(g(),x("ngIf",!i.showLoginPage&&!i.showRegistPage),g(),x("ngIf",i.showRegistPage),g(),x("ngIf",i.showLoginPage))},dependencies:[v,R,D,T],styles:[".button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:10px}.user-system-block[_ngcontent-%COMP%]{width:200px;height:150px;display:flex;flex-wrap:wrap;border-radius:30px;justify-content:center;align-items:center;font-size:2rem;letter-spacing:.5rem;margin:10px;background-color:var(--block-color)}.user-system-block[_ngcontent-%COMP%]:hover{cursor:pointer;transform:translate(10px,-10px);transition:transform .3s ease;box-shadow:-2px 2px 5px 2px #ffffff80}@media (max-width: 576px){.user-system-block[_ngcontent-%COMP%]{width:150px;height:100px;font-size:1.5rem}}"]})};export{G as UserSystemComponent};
